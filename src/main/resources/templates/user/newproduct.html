<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <title>è´­ç‰©å•†åŸ-å•†å“åˆ—è¡¨</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"
        onerror="this.onerror=null;this.href='css/bootstrap.min.css';">
  <!-- Bootstrap å›¾æ ‡ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"
        onerror="this.onerror=null;">
  <!-- å·²æœ‰çš„æœ¬åœ°å¼•ç”¨ä¿ç•™ä½œä¸ºå¤‡é€‰ -->
  <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" id="bootstrap-local" disabled>
  <!-- Bootstrap å›¾æ ‡ æœ¬åœ°é“¾æ¥ -->
  <link rel="stylesheet" th:href="@{/css/bootstrap-icons.css}" id="bootstrap-icons-local" disabled>
  <!-- è‡ªå®šä¹‰æ ·å¼ -->
  <link rel="stylesheet" th:href="@{/css/styles.css}">
  <link rel="stylesheet" th:href="@{/css/product.css}">

</head>
<body class="d-flex flex-column min-vh-100">
<!-- å¯¼èˆªæ   -->
<nav th:insert="~{commons/commons :: navbar}"
     style=" top: 0; left: 100px; right: 0;"></nav>

<!-- ä¸»è¦å†…å®¹ -->
<main class="flex-grow-1 main-container" style="margin-top: 10px;">
  <div class="container">
    <!--    é¢åŒ…å±‘-->
    <nav aria-label="breadcrumb" class="mt-3">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a th:href="@{/u/index.html}">é¦–é¡µ</a></li>
        <li class="breadcrumb-item active" aria-current="page">å•†å“åˆ—è¡¨</li>
      </ol>
    </nav>
    <!-- ç­›é€‰æ  -->
    <form method="get" th:action="@{/u/gonewproduct}">
      <div class="filter-bar">
        <select class="form-select" name="category">
          <option value="">æ‰€æœ‰åˆ†ç±»</option>
          <option th:each="GoodsType : ${goodstypeList}"
                  th:text="${GoodsType.getGoodsTypeName()}"
                  th:value="${GoodsType.getGoodsTypeId()}"
                  th:selected="${#strings.toString(GoodsType.getGoodsTypeId()) == category}">
          </option>
        </select>

        <select class="form-select" name="priceRange">
          <option value="">ä»·æ ¼åŒºé—´</option>
          <option value="0-100" th:selected="${priceRange == '0-100'}">ï¿¥0 - ï¿¥100</option>
          <option value="100-500" th:selected="${priceRange == '100-500'}">ï¿¥100 - ï¿¥500</option>
          <option value="500" th:selected="${priceRange == '500'}">ï¿¥500ä»¥ä¸Š</option>
        </select>

        <button type="submit" class="btn">ç­›é€‰</button>
        <span class="product-count">å…± <span th:text="${count}"></span> ä»¶å•†å“</span>
      </div>
    </form>


    <!-- å•†å“å±•ç¤ºåˆ—è¡¨ -->
    <div class="container">
      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4" id="product-list">
        <!-- å•ä¸ªå•†å“å¡ç‰‡å¾ªç¯ -->
        <div th:each="goods : ${goodsList}" class="col">
          <div class="card h-100 shadow-sm" style="border-color: rgba(255, 87, 34, 0.2); position: relative;">
            <!-- æ•´ä¸ªå¡ç‰‡å¯ç‚¹å‡»åŒºåŸŸ -->
            <a th:href="@{/u/detail/{id}(id=${goods.getGoodsId()})}"
               class="stretched-link text-decoration-none"
               style="color: inherit; z-index: 1;">
              <!-- å•†å“çŠ¶æ€æç¤º -->
              <div class="position-absolute top-0 start-0 p-2" style="z-index: 2;">
                <!-- çŠ¶æ€æ ‡ç­¾å†…å®¹ä¿æŒä¸å˜ -->
                <span th:if="${goods.datetimeHoursDiff <= 72}"
                      class="badge"
                      style="background: rgba(255, 87, 34, 0.9);">æ–°å“ä¸Šå¸‚</span>
                <span th:if="${goods.getInventory() < 50}"
                      class="badge mb-1"
                      style="background-color: rgba(255, 87, 34, 0.6); color: white;"
                      th:text="'ä»…å‰©'+${goods.getInventory}+'ä»¶'"></span>
                <span th:if="${goods.updateHoursDiff <= 24}"
                      class="badge"
                      style="background: rgba(255, 87, 34, 0.9);">çƒ­å–ä¸­ğŸ”¥</span>
              </div>

              <!-- å•†å“å›¾ç‰‡ -->
              <div style="height: 200px; flex-shrink: 0;">
                <img th:src="${goods.getImageUrl()}"
                     class="card-img-top h-100 w-100"
                     style="object-fit: contain; padding: 12px;">
              </div>

              <!-- å¡ç‰‡å†…å®¹ -->
              <div class="card-body d-flex flex-column">
                <h5 class="card-title fs-6"
                    style="color: rgb(255, 87, 34);"
                    th:text="${goods.getGoodsName()}"></h5>

                <div class="d-flex justify-content-between small text-muted">
                  <span th:text="'ä»‹ç»: ' + ${goods.getDescription()}"></span>
                </div>

                <div class="mt-auto">
                  <p class="price fw-bold mb-2"
                     style="color: rgb(255, 87, 34);"
                     th:text="'ï¿¥' + ${#numbers.formatDecimal(goods.getPrice(), 1, 2)}"></p>
                </div>
              </div>
            </a>

            <!-- ç‹¬ç«‹å®šä½çš„è´­ç‰©è½¦æŒ‰é’® -->
            <div class="position-absolute bottom-0 end-0 m-2" style="z-index: 2;">
              <button class="btn cart-btn"
                      style="background-color: #ff5722; color: white;"
                      th:data-delete-url="@{/u/addToCart/{id}(id=${goods.getGoodsId()})}" onclick="confirmDelete(event)">
                åŠ å…¥è´­ç‰©è½¦
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>
    <div class="col-12">
      <h3 class="border-bottom pb-2 d-flex justify-content-between align-items-center">
        <span></span>
        <a th:href="@{/u/goproduct}" class="btn btn-primary px-4 d-flex align-items-center">æŸ¥çœ‹æ›´å¤š</a>
      </h3>
    </div>
  </div>
</main>

<!-- é¡µè„š (å§‹ç»ˆåœ¨åº•éƒ¨) -->
<footer th:insert="~{commons/commons :: footer}"
        style="
               bottom: 0;
               left: 0;
               width: 100%;
               z-index: 1040;  /* é«˜äºä¾§è¾¹æ çš„z-index */
              "> <!-- æ·»åŠ èƒŒæ™¯è‰²ç¡®ä¿è¦†ç›– -->
</footer>
<!-- Bootstrap æœ¬åœ° -->
<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
<!-- jQuery -->
<script th:src="@{/js/jquery-3.7.1.min.js}"></script>
<!--Axios-->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<!-- è‡ªå®šä¹‰è„šæœ¬ -->
<script th:src="@{/js/script.js}"></script>
<script>
  function confirmDelete(event) {
    const deleteUrl = event.currentTarget.getAttribute('data-delete-url');
    window.location.href = deleteUrl;

  }
</script>
</body>

</html>
